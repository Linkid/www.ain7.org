{% extends "annuaire/base.html" %}
{% load i18n ain7_tags %}
{% load static from staticfiles %}

{% block content-left %}

<ul class="list-inline">
<li><a class="btn btn-primary" href="{% url "ain7.annuaire.views.vcard" person.user.id %}"><i class="fa fa-download fa-1g"></i> {% trans "Download vCard" %}</a></li>
{% if superadmin or ca_member or secretariat_member %}
<li><a class="btn btn-primary" href="{% url 'annuaire-edit' person.id %}"><i class="fa fa-pencil fa-1g"></i> {% trans "Edit" %}</a></li>
<li><a class="btn btn-primary" href="{% url "ain7.adhesions.views.user_subscriptions" person.user.id %}"><i class="fa fa-money fa-1g"></i> {% trans "Subscriptions History" %}</a></li>
<li><a class="btn btn-primary" href="{% url 'send-new-credentials' person.id %}"><i class="fa fa-envelope-o fa-1g"></i> {% trans "Send new credentials" %}</a></li>
<li><a class="btn btn-primary" href="{% url 'member-add' %}"><i class="fa fa-plus fa-1g"></i> {% trans "Add" %}</a></li>
{% endif %}

</ul>

<h1>{{ person.first_name }} {{ person.last_name }}</h1>

{% if is_subscriber %}
<b>{% trans "Subscriber" %} {% now "Y" %} <img src="{% static "logo_ain7.png" %}" alt="adherent" width="25" height="25" /></b>
{% endif %}

<br>
<br>
<br>

<table border="0" width="100%">
<tr><td>
<ul>
   {% if person.maiden_name %}
   <li><b>{% filter capfirst %}{% trans "maiden name" %}{% endfilter %}
       &nbsp;:</b> {{ person.maiden_name }}</li>
   {% endif %}
   {% if ain7member.promos %}
   <li><b>{% trans "Promos" %}&nbsp;:</b> {% for promo in ain7member.promos.all %}{{ promo }}{% if not forloop.last %} - {% endif %}{% endfor %}</li>
   {% endif %}
   {% if ain7member.nick_name %}
   <li><b>{% trans "Nick name" %}&nbsp;:</b> {{ ain7member.nick_name }}</li>
   {% endif %}
   {% if ain7member.education.all %}
   <li><b>{% filter capfirst %}{% trans "diplomas" %}{% endfilter %}&nbsp;:</b>
       {% for educ in ain7member.education.all %}{{ educ.diploma }}
           {% if educ.diploma and not forloop.last %} ; {% endif %}{% endfor %}</li>
   {% endif %}
   {% if person.birth_date %}
   <li><b>{% trans "Birth date" %}&nbsp;:</b> {{ person.birth_date|date:"d F Y" }}</li>
   {% endif %}
   {% if personprivate.death_date %}
   <li><b>{% filter capfirst %}{% trans "death date" %}{% endfilter %}
       &nbsp;:</b> {{ personprivate.death_date|date:"d/m/Y" }}</li>
   {% endif %}
   {% if superadmin or ca_member or secretariat_member or is_myself %}
   {% if ain7member.marital_status or ain7member.children_count %}
   <li><i class="fa fa-lock"></i> <b>{% trans "Family situation" %}&nbsp;:</b>
       {% if ain7member.marital_status %}
           {{ ain7member.marital_status }}&nbsp;
       {% endif %}
       {% if ain7member.children_count %}
           {{ ain7member.children_count }}&nbsp;{% trans "children" %}
       {% endif %}
   </li>
   {% endif %}
   {% endif %}
   {% if ain7member.decorations.all %}
   <li><b>{% filter capfirst %}{% trans "decorations" %}{% endfilter %}
       &nbsp;:</b>
       {% for decoration in ain7member.decorations.all %}{{ decoration }}
           {% if not forloop.last %} - {% endif %}{% endfor %}</li>
   {% endif %}
   {% if ain7member.ceremonial_duties.all %}
   <li><b>{% filter capfirst %}{% trans "ceremonial duties" %}{% endfilter %}
       &nbsp;:</b>
       {% for duty in ain7member.ceremonial_duties.all %}{{ duty }}
           {% if not forloop.last %} - {% endif %}{% endfor %}</li>
   {% endif %}
</ul>
</td><td>
{% if ain7member.avatar %}
	<img src="{{ ain7member.avatar.url }}" height="100" alt="{{ person.complete_name }}"/>
{% else %}
	<img src="{% static "images/nobody.png" %}" height="100" alt="{{ person.complete_name }}"/>
{% endif %}
</td></tr>
</table>

<h2>{% trans "Contact" %}</h2>
<table border="0" width="100%">
<tbody>
{% for phone_number in person.phone_numbers.all %}
    {% if superadmin or ca_member or secretariat_member or is_myself or not phone_number.website_confidential %}
    <tr><td>{% if phone_number.website_confidential %}<i class="fa fa-lock"></i> {% endif %}<b>{{ phone_number.get_type_display }} :</b> {{ phone_number.number }}</td></tr>
    {% endif %}
{% endfor %}
{% for position in ain7member.positions.all %}
{% if position.phone_number and not position.end %}
<tr><td><b>{% trans "Professional Phone:" %}</b> {{ position.phone_number }}</td></tr>
{% endif %}
{% endfor %}

{% for email in person.emails.all %}
	{% if superadmin or ca_member or secretariat_member or is_myself or not  email.website_confidential %}
            {% if not email.position or not email.position.end %}
            <tr><td>{% if email.website_confidential %}<i class="fa fa-lock"></i>{% endif %}<li class="fa fa-envelope-o"></i>&nbsp;<a href="mailto:{{ email.email }}">{{ email.email }}</a></td></tr>
            {% endif %}
	{% endif %}
{% endfor %}

{% for web_site in person.web_sites.all %}
<tr><td><i class="fa fa-{{ web_site.get_type_display|lower }}"/></i>&nbsp;<a href="{{ web_site.url }}">{{ web_site.url }}</a></td></tr>
{% endfor %}
</tbody>
</table>

<table border="0" width="100%">
<tbody>
{% for address in person.addresses.all %}
	{% if superadmin or ca_member or secretariat_member or is_myself or not address.website_confidential %}
    <tr><td>{% if address.website_confidential %}<i class="fa fa-lock"></i> {% endif %}<b>{% trans "Address" %} {{ address.type|lower }} :</b> {{ address.line1 }} {{ address.line2|default_if_none:"" }} - {{address.zip_code }} {{ address.city }} - {{ address.country.name }}</td></tr>
	{% endif %}
{% endfor %}
{% for position in ain7member.positions.all %}
{% if not position.end and position.office.line1 %}
<tr><td><b>{% trans "Professionnal Address:" %}</b> {{ position.office.line1 }} {{ position.office.line2|default_if_none:"" }} - {{ position.office.zip_code }} {{ position.office.city }} - {{ position.office.country.name }}</td></tr>
{% endif %}
{% endfor %}
</tbody>
</table>

{% if ain7member.positions.all %}

{% if ain7member.display_cv_in_directory or superadmin or ca_member or is_myself or secretariat_member %}

<h2>{% if not ain7member.display_cv_in_directory %}<i class="fa fa-lock"></i> {% endif %}
{% trans "Career" %}</h2>

<ul>
{% for position in ain7member.positions.all %}
<li>
    {% if position.begin and not position.end %}
       {% trans "since" %} <b>{{ position.begin }}</b>&nbsp;:
          {% else %}{% if position.begin and position.end %}
             <b>{{ position.begin }}-{{ position.end }}</b>:
          {% else %}{% if position.end %}
             {% trans "until" %} {{position.end }}</b>&nbsp;:
          {% endif %}
          {% endif %}{% endif %}
            {% if position.fonction %}<em>{{ position.fonction }}</em>, {% endif %}
                <a href="{% url "ain7.organizations.views.organization_details" position.office.organization.id %}">{{ position.office.organization }}</a>
        {% if position.description %}
            {{ position.description|safe }}
        {% endif %}
</li>
{% endfor %}
</ul>
{% endif %}
{% endif %}

{% if ain7member.club_memberships.all %}

<h2>{% trans "N7 associative activities" %}</h2>

<ul>

{% for club_membership in ain7member.person.council_roles.all %}
    <li>
    {% if club_membership.grouphead.group.web_site %}
        <a href="{{ club_membership.grouphead.group.web_site }}">{{ club_membership.grouphead.group.name }}</a>
    {% else %}
        {{ club_membership.grouphead.group.name }}
    {% endif %}
    {% if club_membership.title %}
       : {{ club_membership.title }}
    {% endif %}
    {% if club_membership.start_date and club_membership.end_date %}
    (<i>{{ club_membership.start_date|date:"Y" }} - {{ club_membership.end_date|date:"Y" }}</i>)
    {% endif %}
    </li>
{% endfor %}

</ul>
{% endif %}

{% if person.groups.all %}
<h2>{% trans "Groups" %}</h2>

<ul>
{% for group in person.groups.all %}
	    <li><a href="{% url "ain7.groups.views.details" group.group.slug %}">{{ group.group.name }}</a></li>
{% endfor %}
</ul>
{% endif %}

{% endblock %}
