{% extends "association/base.html" %}
{% load i18n %}

{% block javascript %}
{# Par defaut, on importe ces codes javascript sur toutes les pages. #}
{# Rien n'empeche de redefinir ce bloc pour certaines pages... #}
<!-- calendar -->
<script src="/site_media/js/calendar/calendar.js" type="text/javascript"></script>
<!-- this is translation file for calendar - choose your language here -->
<script src="/site_media/js/calendar/lang/calendar-en.js" type="text/javascript"></script>
<script src="/site_media/js/calendar/calendar-setup.js" type="text/javascript"></script>
<!-- /calendar -->
<script src="/site_media/js/mootools-{{ mootools_version }}-core-nc.js" type="text/javascript"></script>
<script src="/site_media/js/mootools-{{ mootools_more_version }}-more.js" type="text/javascript"></script> 
<script src="/site_media/js/autocomplete.js?version={{ portal_version }}" type="text/javascript"></script>
{% endblock %}

{% block content-left %}

<h3>{% trans "Administration Council" %}</h3>

{% ifequal all_current "all" %}
  {% trans "All members (including past ones) are displayed. Click" %} <a href="{% url ain7.association.views.edit_council "current" %}">{% trans "here" %}</a> {% trans "to display only current ones." %}
{% else %}
  {% trans "Only current members are displayed. Click" %} <a href="{% url ain7.association.views.edit_council "all" %}">{% trans "here" %}</a> {% trans "to display past members too." %}
{% endifequal %}



{% for type, type_display, type_form, roles in roles_by_type %}

  <h4>{{ type_display }}</h4>

  {% if roles %}
    <ul>
      {% for role, role_form in roles %}
        <li>
          {% if role_form %}<div class="formBlock">{% endif %}
          <a href="{% url ain7.annuaire.views.details role.member.id %}">{{ role.member }}</a>&nbsp;
          {% if not role_form %}
            ({{ role.start_date|date:"d/m/Y" }} - 
             {% if role.end_date %} {{ role.end_date|date:"d/m/Y" }})
             {% else %} ...)
             {% endif %}&nbsp;<br/>
            <a href="{% url ain7.association.views.change_council_dates role.id,all_current %}" class="changelink">{% trans "Modify dates" %}</a>&nbsp;
            <a href="{% url ain7.association.views.delete_council_role role.id,all_current %}" class="deletelink">{% trans "Delete" %}</a>&nbsp;
          {% else %}
            <form method="post" action=".">
              <table>
                <tr>
                  <td>{{ role_form.start_date.label_tag }}</td>
                  <td>{% if role_form.start_date.errors %}
                        {{ role_form.start_date.errors }}
                      {% endif %}
                      {{ role_form.start_date|safe }}</td>
                </tr>
                <tr>
                  <td>{{ role_form.end_date.label_tag }}</td>
                  <td>{% if role_form.end_date.errors %}
                        {{ role_form.end_date.errors }}
                      {% endif %}
                      {{ role_form.end_date|safe }}</td>
                </tr>
              </table>
              <div style="text-align: center">
                <a class="button" href="{{ back }}">{% trans "Cancel" %}</a>
                <input type="submit" class="button" value="{% trans "Save" %}" />
              </div>
            </form>
            </div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if type_form %}
    <div class="formBlock">
      <h4>{% trans "Add a" %} {{ type_display|lower }}</h4>
      <form method="post" action=".">
        <table>
          <tr>
            <td>{{ type_form.username.label_tag }}</td>
            <td>{% if type_form.username.errors %}
                  {{ type_form.username.errors }}
                {% endif %}
                {{ type_form.username|safe }}</td>
          </tr>
          <tr>
            <td>{{ type_form.start_date.label_tag }}</td>
            <td>{% if type_form.start_date.errors %}
                  {{ type_form.start_date.errors }}
                {% endif %}
                {{ type_form.start_date|safe }}</td>
          </tr>
          <tr>
            <td>{{ type_form.end_date.label_tag }}</td>
            <td>{% if type_form.end_date.errors %}
                  {{ type_form.end_date.errors }}
                {% endif %}
                {{ type_form.end_date|safe }}</td>
          </tr>
          <tr>
            <td>{{ type_form.board_member.label_tag }}</td>
            <td>{% if type_form.board_member.errors %}
                  {{ type_form.board_member.errors }}
                {% endif %}
                {{ type_form.board_member|safe }}</td>
          </tr>
        </table>
        <div style="text-align: center">
          <a class="button" href="{{ back }}">{% trans "Cancel" %}</a>
          <input type="submit" class="button" value="{% trans "Save" %}" />
        </div>
      </form>
    </div>
  {% else %}
    <a href="{% url ain7.association.views.add_council_role %}" class="addlink">{% trans "Add" %}</a>
  {% endif %}

{% endfor %}

{% endblock %}
