{% extends "annuaire/base.html" %}

{% load i18n %}

{% block javascript %}
<script type="text/javascript" src="/site_media/js/mootools-release-{{ mootools_version }}.js"></script>
<script type="text/javascript" src="/site_media/js/autocomplete.js?version={{ portal_version }}"></script>
<script type="text/javascript" src="/site_media/js/floatingpane.js?version={{ portal_version }}"></script>
{% endblock %}

{% block stylesheet %}
<link type="text/css" rel="stylesheet" href="/site_media/css/autocomplete.css?version={{ portal_version }}"/>
<link type="text/css" rel="stylesheet" href="/site_media/css/floatingpane.css?version={{ portal_version }}"/>
{% endblock %}

{% block content %}

<div id="content-main">

<div class="left">

<form action="." method="post">
<div>

<div id="edition">

{% if conditionsList %}
  <table class="datas">
    {% for condition in conditionsList %}
      <tr class="{% cycle row1,row2 %}">
        <td>{% if not forloop.first %}
          <a href="/annuaire/advanced_search/sessionFilter/swapOp/">
            {{ filterOperator }}
          </a>
          {% endif %}
        </td>
        {% ifequal condition.1 "field" %}
          <td>{% filter capfirst %}{{ condition.4 }}{% endfilter %}</td>
          <td>{{ condition.5 }}</td>
          <td>{{ condition.7 }}</td>
        {% else %}
          <td>
            {% ifequal condition.3 "True" %}
              {% trans "belongs to filter" %}
            {% else %}
              {% trans "does not belong to filter" %}
            {% endifequal %}
          </td>
          <td>&nbsp;</td>
          <td>{{ condition.2 }}</td>
        {% endifequal %}
        <td><a href="/annuaire/advanced_search/sessionFilter/criterion/{{ condition.0 }}/edit/{{ condition.1 }}/" class="changelink">{% trans "Modify" %}</a></td>
        <td><a href="/annuaire/advanced_search/sessionFilter/criterion/{{ condition.0 }}/delete/{{ condition.1 }}/" class="deletelink">{% trans "Delete" %}</a></td>
      </tr>
    {% endfor %}
  </table>
{% else %}
    <p>{% trans "No criterion. Please add one." %}</p>
{% endif %}

</div>

    <a href="/annuaire/advanced_search/sessionFilter/criterion/add/" 
       class="addlink">{% trans "Add a criterion" %}</a>

<div align="center">
    <input type="submit" class="button" value="{% trans "Search" %}" />
</div>

</div>

</form>

{% if ain7members %}

{% ifnotequal ain7members|length 0 %}

<h2>{% trans "Results list"%}</h2>
<table width="100%">
<tr>
<td><b>{{ first_result }} â†’ {{ last_result }}</b> {% trans "of" %} {{ hits }} {% trans "results" %}</td>
<td align="right">
{% if is_paginated %}
{% if has_previous %}<a href="/annuaire/advanced_search/?page=1">{% trans "First" %}</a>{% else %}{% trans "First" %}{% endif %} - 
{% if has_previous %}<a href="/annuaire/advanced_search/?page={{ previous_page }}">{% trans "Previous" %}</a>{% else %}{% trans "Previous" %}{% endif %} - 
{% if has_next %}<a href="/annuaire/advanced_search/?page={{ next_page }}">{% trans "Next" %}</a>{% else %}{% trans "Next" %}{% endif %} -
{% if has_next %}<a href="/annuaire/advanced_search/?page={{ pages }}">{% trans "Last" %}</a>{% else %}{% trans "Last" %}{% endif %}
{% endif %}
</td>
</table>
    <ul>
    {% for ain7member in ain7members %}
        <li class="person"><a href="/annuaire/{{ ain7member.person.user.id }}/">
            {{ ain7member.person.last_name }} {{ ain7member.person.first_name }}</a> 
            {% for promo in ain7member.promos.all %}
               {% if forloop.last %} ({{ promo }}){% endif %}
            {% endfor %}
				</li>
    {% endfor %}
     </ul>
{% else %}
    <p>{% trans "No person matched your criteria." %}</p>
{% endifnotequal %}

{% endif %}

</div>


<div class="right">

   <h3>{% trans "Actions" %}</h3>
   <div class="right_articles">
    <ul>
      <li><a href="/annuaire/advanced_search/sessionFilter/reset/">
             {% trans "Reset this filter" %}</a></li>
      <li><a href="/annuaire/advanced_search/sessionFilter/register/">
             {% trans "Save this filter" %}</a></li>
      <li><a href="/annuaire/csv/">
          {% trans "Export as CSV" %}</a></li>
      <li><a href="/annuaire/sendmail/">
          {% trans "Send a mail" %}</a></li>
    </ul>
   </div>

   <h3>{% trans "Navigation" %}</h3>
   <div class="right_articles">
   <ul>
      <li><a href="/annuaire/">
          {% trans "Simple Search" %}</a></li>
   </ul>
   </div>

   <h3>{% trans "Registered filters" %}</h3>
   <div class="right_articles">
   {% if userFilters %}
   <ul>
       {% for filter in userFilters %}
         <li>
           <a href="/annuaire/advanced_search/filter/{{ filter.id }}/">
             {{ filter }}</a>
         </li>
       {% endfor %}
   </ul>
   {% else %}
     {% trans "No registered filter" %}
   {% endif %}
   </div>
</div>

</div>

{% endblock %}
